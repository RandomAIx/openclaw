export type Locale = "en" | "zh-CN";

type TranslationTable = Record<string, string>;

const TRANSLATIONS: Record<Locale, TranslationTable> = {
  en: {
    "nav.chat": "Chat",
    "nav.control": "Control",
    "nav.agent": "Agent",
    "nav.settings": "Settings",
    "nav.resources": "Resources",
    "nav.docs": "Docs",
    "nav.docsTitle": "Docs (opens in new tab)",
    "tab.overview": "Overview",
    "tab.channels": "Channels",
    "tab.instances": "Instances",
    "tab.sessions": "Sessions",
    "tab.cron": "Cron Jobs",
    "tab.skills": "Skills",
    "tab.nodes": "Nodes",
    "tab.chat": "Chat",
    "tab.config": "Config",
    "tab.debug": "Debug",
    "tab.logs": "Logs",
    "tab.overview.subtitle": "Gateway status, entry points, and a fast health read.",
    "tab.channels.subtitle": "Manage channels and settings.",
    "tab.instances.subtitle": "Presence beacons from connected clients and nodes.",
    "tab.sessions.subtitle": "Inspect active sessions and adjust per-session defaults.",
    "tab.cron.subtitle": "Schedule wakeups and recurring agent runs.",
    "tab.skills.subtitle": "Manage skill availability and API key injection.",
    "tab.nodes.subtitle": "Paired devices, capabilities, and command exposure.",
    "tab.chat.subtitle": "Direct gateway chat session for quick interventions.",
    "tab.config.subtitle": "Edit ~/.openclaw/openclaw.json safely.",
    "tab.debug.subtitle": "Gateway snapshots, events, and manual RPC calls.",
    "tab.logs.subtitle": "Live tail of the gateway file logs.",
    "topbar.expand": "Expand sidebar",
    "topbar.collapse": "Collapse sidebar",
    "topbar.gatewayDashboard": "Gateway Dashboard",
    "topbar.health": "Health",
    "topbar.health.ok": "OK",
    "topbar.health.offline": "Offline",
    "topbar.language": "Language",
    "topbar.language.en": "English",
    "topbar.language.zh": "中文",
    "chat.refresh": "Refresh chat data",
    "chat.thinking.disabled": "Disabled during onboarding",
    "chat.thinking.toggle": "Toggle assistant thinking/working output",
    "chat.focus.disabled": "Disabled during onboarding",
    "chat.focus.toggle": "Toggle focus mode (hide sidebar + page header)",
    "chat.disconnected": "Disconnected from gateway.",
  },
  "zh-CN": {
    "nav.chat": "对话",
    "nav.control": "控制",
    "nav.agent": "代理",
    "nav.settings": "设置",
    "nav.resources": "资源",
    "nav.docs": "文档",
    "nav.docsTitle": "文档（在新标签页打开）",
    "tab.overview": "概览",
    "tab.channels": "频道",
    "tab.instances": "实例",
    "tab.sessions": "会话",
    "tab.cron": "定时任务",
    "tab.skills": "技能",
    "tab.nodes": "节点",
    "tab.chat": "对话",
    "tab.config": "配置",
    "tab.debug": "调试",
    "tab.logs": "日志",
    "tab.overview.subtitle": "网关状态、入口信息与快速健康检查。",
    "tab.channels.subtitle": "管理频道与相关设置。",
    "tab.instances.subtitle": "已连接客户端与节点的在线状态。",
    "tab.sessions.subtitle": "查看活动会话并调整默认值。",
    "tab.cron.subtitle": "安排唤醒与周期性运行。",
    "tab.skills.subtitle": "管理技能可用性与 API Key 注入。",
    "tab.nodes.subtitle": "已配对设备、能力与命令开放情况。",
    "tab.chat.subtitle": "快速干预的网关直连会话。",
    "tab.config.subtitle": "安全编辑 ~/.openclaw/openclaw.json。",
    "tab.debug.subtitle": "网关快照、事件与手动 RPC 调用。",
    "tab.logs.subtitle": "实时尾随网关日志文件。",
    "topbar.expand": "展开侧边栏",
    "topbar.collapse": "收起侧边栏",
    "topbar.gatewayDashboard": "网关控制台",
    "topbar.health": "健康",
    "topbar.health.ok": "正常",
    "topbar.health.offline": "离线",
    "topbar.language": "语言",
    "topbar.language.en": "English",
    "topbar.language.zh": "中文",
    "chat.refresh": "刷新对话数据",
    "chat.thinking.disabled": "引导期间不可用",
    "chat.thinking.toggle": "切换助手思考/工作输出",
    "chat.focus.disabled": "引导期间不可用",
    "chat.focus.toggle": "切换专注模式（隐藏侧边栏与页头）",
    "chat.disconnected": "已与网关断开连接。",
  },
};

export function normalizeLocale(value: string | null | undefined): Locale {
  if (!value) return "en";
  const normalized = value.trim().toLowerCase();
  return normalized.startsWith("zh") ? "zh-CN" : "en";
}

export function createTranslator(locale: Locale) {
  const table = TRANSLATIONS[locale] ?? TRANSLATIONS.en;
  return (key: string, fallback?: string) => table[key] ?? fallback ?? key;
}

